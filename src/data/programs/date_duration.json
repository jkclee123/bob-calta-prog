{
  "id": "date_duration",
  "name": {
    "en": "Date Duration",
    "zh": "日期差距"
  },
  "description": {
    "en": "Calculate the number of days between two dates (excluding end date).",
    "zh": "計算兩個日期之間的日數（不包括結束日）。"
  },
  "image": "/images/programs/date_duration.png",
  "mode": "REG Lin",
  "code": [
    {
      "code": "?→X:?→Y:ClrStat:Deg:X,YDT:0→M:Fix 0:",
      "bytes": 24,
      "comment": {
        "en": "Input start date and end date",
        "zh": "輸入開始日期及結束日期"
      }
    },
    {
      "code": "Rnd(G-.5+X₁₀^(-4→A:X-A₁₀^(4→X:",
      "bytes": 21,
      "comment": {
        "en": "Retrieve start date year",
        "zh": "讀取開始日期年份"
      }
    },
    {
      "code": "Rnd(G-.5+Y₁₀^(-4→B:Y-B₁₀^(4→Y:",
      "bytes": 21,
      "comment": {
        "en": "Retrieve end date year",
        "zh": "讀取結束日期年份"
      }
    },
    {
      "code": "0→C:X≥301⇒1→C:",
      "bytes": 14,
      "comment": {
        "en": "Check if start date is on or after 1st of March",
        "zh": "檢查開始日期是否在3月1日之後"
      }
    },
    {
      "code": "For A→A To B-1:A+C:",
      "bytes": 13,
      "comment": {
        "en": "Loop from start date year to end date year",
        "zh": "由開始年份循環至結束年份"
      }
    },
    {
      "code": "M+365+(sin(45Ans)=0)(sin(1.8Ans)≠0)+(0=sin(.45Ans→M:Next:",
      "bytes": 37,
      "comment": {
        "en": "Sum days in each year",
        "zh": "總和每年日數"
      }
    },
    {
      "code": "Rnd(.01X-.5→C:Rnd(.01Y-.5→D:M-X+Y+100(C-D→M:",
      "bytes": 38,
      "comment": {
        "en": "Retrieve start date month and end date month",
        "zh": "讀取開始月份及結束月份"
      }
    },
    {
      "code": "∑x→X:∑y→Y:",
      "bytes": 8,
      "comment": {
        "en": "Load start date and end date back to input",
        "zh": "載入開始日期及結束日期到輸入"
      }
    },
    {
      "code": "1→A:If C>D:Then C→A:D→C:A→D:-1→A:IfEnd:",
      "bytes": 29,
      "comment": {
        "en": "Determine whether to add or subtract days",
        "zh": "決定月份應該向前或向後移動"
      }
    },
    {
      "code": "For C→C To D-1:",
      "bytes": 9,
      "comment": {
        "en": "Loop from start date month to end date month",
        "zh": "由開始月份循環至結束月份"
      }
    },
    {
      "code": "If C≠2:Then M+A(31-(1=Abs(Abs(C-7.5)-2.5→M:",
      "bytes": 31,
      "comment": {
        "en": "Add or subtract days in each month (except February)",
        "zh": "加或減每月日數（除2月）"
      }
    },
    {
      "code": "Else M+A(28+(sin(45B)=0)(sin(1.8B)≠0)+(0=sin(.45B→M:IfEnd:",
      "bytes": 41,
      "comment": {
        "en": "Special handling: Add or subtract days in February",
        "zh": "特別處理：加或減2月日數"
      }
    },
    {
      "code": "Next:Norm 2:M",
      "bytes": 6,
      "comment": {
        "en": "Display result",
        "zh": "顯示結果"
      }
    }
  ],
  "guide": {
    "parameters": {
      "en": [
        "X: Start date (yyyyMMdd)",
        "Y: End date (yyyyMMdd)",
        "M: Sum of days between two dates (excluding end date)"
      ],
      "zh": [
        "X: 開始日期 (yyyyMMdd)",
        "Y: 結束日期 (yyyyMMdd)",
        "M: 日期差距（不包括結束日）"
      ]
    },
    "instructions": {
      "en": [
        "Enter start date X in format yyyyMMdd",
        "Enter end date Y in format yyyyMMdd"
      ],
      "zh": [
        "輸入開始日期 X，格式 yyyyMMdd",
        "輸入結束日期 Y，格式 yyyyMMdd"
      ]
    },
    "examples": [
      {
        "title": {
          "en": "Calculate days between dates",
          "zh": "計算日期間天數"
        },
        "steps": [
          {
            "en": "Input X = 20240415 (April 15, 2024)",
            "zh": "輸入 X = 20240415（2024年4月15日）"
          },
          {
            "en": "Input Y = 20250609 (June 9, 2025)",
            "zh": "輸入 Y = 20250609（2025年6月9日）"
          },
          {
            "en": "Result: M = 420 days",
            "zh": "結果：M = 420日"
          }
        ]
      }
    ]
  },
  "analysis": [
    {
      "title": {
        "en": "Leap Year Check",
        "zh": "檢查閏年"
      },
      "problem": {
        "en": "A leap year occurs when a year is divisible by 4, with the exception that years divisible by 100 are not leap years unless they are also divisible by 400. Casio FX-50FH II does not have a modulo operator, it cannot effciently check for divisibility by 4, 100, and 400.",
        "zh": "閏年是指可以被4整除，但不可以被100整除，除非可以被400整除嘅年份。Casio FX-50FH II 沒有模運算，無法有效地檢查4、100和400的整除性。"
      },
      "image": "/images/analysis/leap_year_graph.png",
      "solution": {
        "en": "Use sine functions instead of modulo operator. As seen in the graph, the blue statement is true when x is a multiple of 4, the red statement is true when x is a multiple of 100, the green statement is true when x is a multiple of 400.",
        "zh": "我們可以用 sine 函數來檢查4、100和400的整除性。圖中，藍語句在4的倍數處為真，紅語句在100的倍數處為真，綠語句在400的倍數處為真。"
      },
      "steps": [
        {
          "title": {
            "en": "Condition 1: Divisible by 4",
            "zh": "條件一：被 4 整除"
          },
          "formula": "sin(45°x) = 0",
          "explanation": {
            "en": "Sine of product of 45 and x is always 0, if x is a multiple of 4.",
            "zh": "當K是4的倍數時，45乘K的sine值都是零。"
          }
        },
        {
          "title": {
            "en": "Condition 2: NOT Divisible by 100",
            "zh": "條件二：不被 100 整除"
          },
          "formula": "sin(1.8°x) ≠ 0",
          "explanation": {
            "en": "Sine of product of 1.8 and x is always 0, if x is a multiple of 100. When x is not a multiple of 100, its sine value is not 0.",
            "zh": "當x不是100的倍數時，1.8乘K的sine值不是零。"
          }
        },
        {
          "title": {
            "en": "Condition 3: Divisible by 400",
            "zh": "條件三：被 400 整除"
          },
          "formula": "sin(0.45°x) = 0",
          "explanation": {
            "en": "Sine of product of 0.45 and x is always 0, if x is a multiple of 400.",
            "zh": "當x是400的倍數時，0.45乘x的sine值都是零。"
          }
        },
        {
          "title": {
            "en": "Putting All Conditions Together",
            "zh": "組合所有條件"
          },
          "formula": "([Condition 1] AND [Condition 2]) OR [Condition 3]",
          "explanation": {
            "en": "Putting all conditions into a logic statement gives us the leap year checking formula.",
            "zh": "將所有條件組合成一條邏輯陳述，就得到閏年檢查公式。"
          }
        },
        {
          "title": {
            "en": "Leap Year Checking Formula",
            "zh": "閏年檢查公式"
          },
          "formula": "(sin(45x) = 0)(sin(1.8x) ≠ 0) + (sin(0.45x) = 0)",
          "explanation": {
            "en": "",
            "zh": ""
          }
        }
      ]
    },
    {
      "title": {
        "en": "Filter Months with 30 Days",
        "zh": "計算有30天的月份"
      },
      "problem": {
        "en": "There are 4 months with 30 days in a year, April, June, September and November. Using if statements to check would use a lot of memory.",
        "zh": "一年有4個月有30天，四月、六月、九月和十一月，使用if語句來檢查需要用很多字節。"
      },
      "image": "/images/analysis/days_in_month.png",
      "solution": {
        "en": "We can use a single statement to filter months with 30 days. As seen in the graph, the function intersects with y = 1 at x = 4, x = 6, x = 9 and x = 11.",
        "zh": "我們可以用一條語句來檢查哪個月份有30天。圖中，函數在x = 4、x = 6、x = 9和x = 11處與y = 1相交。"
      },
      "steps": [
        {
          "title": {
            "en": "Core Statement",
            "zh": "核心語句"
          },
          "formula": "||x - 7.5|-2.5| = 1",
          "explanation": {
            "en": "When x is 4, 6, 9 or 11, LHS equals to 1. When substituting x with months with 30 days, the statement is true.",
            "zh": "當x是4、6、9或11時，公式等於1。當x是30天的月份時，語句為真。"
          }
        }
      ]
}
  ]
} 