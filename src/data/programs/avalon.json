{
  "id": "avalon",
  "name": {
    "en": "Avalon",
    "zh": "阿瓦隆"
  },
  "description": {
    "en": "Assistant program for The Resistance: Avalon board game. Functions include drawing character cards, a discussion timer, randomly selecting a leader, and playing quest cards.",
    "zh": "桌遊阿瓦隆程式，功能包括抽身份牌、討論計時器、隨機選出領袖和出任務牌。"
  },
  "image": "/images/programs/avalon.png",
  "mode": "Comp",
  "memory": 302,
  "code": [
    {
      "code": "Lbl 0:Norm 2:60→M:?→M:",
      "bytes": 15,
      "comment": {
        "en": "Function Selection Menu",
        "zh": "功能選單"
      }
    },
    {
      "code": "Fix 0:M=0⇒Goto 2:M>5⇒Goto 1:M>0⇒Goto 8:",
      "bytes": 24,
      "comment": {
        "en": "Route to different function",
        "zh": "根據輸入跳轉不同功能"
      }
    },
    {
      "code": "-MRan#+.5◢",
      "bytes": 7,
      "comment": {
        "en": "Randomly select a leader",
        "zh": "隨機選出領袖"
      }
    },
    {
      "code": "Lbl 1:50M→M:For 1→D To M:Next:Goto 0:",
      "bytes": 21,
      "comment": {
        "en": "Discussion Timer",
        "zh": "討論計時器"
      }
    },
    {
      "code": "Lbl 2:?→A:?→B:?→C:ClrStat:0DT:Lbl 3:A-n+1→Y:",
      "bytes": 31,
      "comment": {
        "en": "Draw Character Cards: Set up",
        "zh": "抽身份牌：設定"
      }
    },
    {
      "code": "Rnd(10³Ran#÷Rnd(10³÷Y-.5)+.5→D:D>Y⇒Goto 3:",
      "bytes": 29,
      "comment": {
        "en": "Draw Character Cards: Generate random number",
        "zh": "抽身份牌：生成隨機數"
      }
    },
    {
      "code": "∑x→M:-1→X:",
      "bytes": 9,
      "comment": {
        "en": "Draw Character Cards: Load \"Drawn Card Memory\"",
        "zh": "抽身份牌：載入「已抽牌記憶」"
      }
    },
    {
      "code": "While D:D-(M<1→D:10(M-(M≥1→M:X+1→X:WhileEnd:",
      "bytes": 32,
      "comment": {
        "en": "Draw Character Cards: Find actual card number",
        "zh": "抽身份牌：找出實際牌號"
      }
    },
    {
      "code": "-Y◢₁₀^(-XDT:X-B→X:",
      "bytes": 14,
      "comment": {
        "en": "Draw Character Cards: Display number of remaining cards",
        "zh": "抽身份牌：顯示剩餘牌數"
      }
    },
    {
      "code": "If X≥0:Then (Gσσ)⁻¹(69-(68-X)(X< C→D:GσσD◢",
      "bytes": 34,
      "comment": {
        "en": "Draw Character Cards: Display good loyalty card",
        "zh": "抽身份牌：顯示好人陣營角色"
      }
    },
    {
      "code": "Else -X÷BA→D:BAD◢IfEnd:",
      "bytes": 15,
      "comment": {
        "en": "Draw Character Cards: Display evil loyalty card",
        "zh": "抽身份牌：顯示壞人陣營角色"
      }
    },
    {
      "code": "Y>1⇒Goto 3:0→X:ClrStat:Goto 0:",
      "bytes": 16,
      "comment": {
        "en": "Draw Character Cards: Continue drawing",
        "zh": "抽身份牌：繼續抽牌"
      }
    },
    {
      "code": "Lbl 8:0→X:For -M→M To -1:",
      "bytes": 16,
      "comment": {
        "en": "Play Quest Cards: Set up",
        "zh": "出任務牌：設定"
      }
    },
    {
      "code": "Lbl 9:M→D:?→D:D≠0⇒D≠1⇒Goto 9:X+D→X:Next:",
      "bytes": 30,
      "comment": {
        "en": "Play Quest Cards: Success/Failure",
        "zh": "出任務牌：任務成功／失敗"
      }
    },
    {
      "code": "tFBσYZ₀◢X◢Goto 0",
      "bytes": 11,
      "comment": {
        "en": "Play Quest Cards: Display number of failure quest cards",
        "zh": "出任務牌：顯示任務失敗牌數量"
      }
    }
  ],
  "guide": {
    "parameters": {
      "en": [
        "Function Selection Menu:",
        "- M: Function select variable",
        "Character Drawing:",
        "- A: Number of players",
        "- B: Number of evil loyalty characters",
        "- C: Number of good loyalty special characters",
        "Play Quest Card:",
        "- D: Quest card type (0: success, 1: failure)",
        "- X: Number of failure quest cards"
      ],
      "zh": [
        "功能選單：",
        "- M: 功能選擇變數",
        "抽身份牌：",
        "- A: 玩家人數",
        "- B: 壞人陣營角色人數",
        "- C: 好人陣營特殊角色人數",
        "出任務牌：",
        "- D: 任務牌類型（0: 成功，1: 失敗）",
        "- X: 任務失敗牌數量"
      ]
    },
    "instructions": {
      "en": [
        "Randomly select a leader from N players: input -N to M",
        "Time N seconds: input N to M",
        "Play N quest cards: input N to M (N less than or equal to 5)",
        "Draw character cards: input 0 to M"
      ],
      "zh": [
        "隨機選出N個玩家領袖：輸入-N到M",
        "計時N秒：輸入N到M",
        "出N張任務牌：輸入N到M（N小於或等於5）",
        "抽角色牌：輸入0到M"
      ]
    },
    "examples": [
      {
        "title": {
          "en": "Function 1 - Random Select Leader",
          "zh": "功能1 - 隨機選出領袖"
        },
        "steps": [
          {
            "en": "Input -10 to M (random number from 1 to 10)",
            "zh": "輸入-10到M（隨機數1至10）"
          },
          {
            "en": "Program displays: 7",
            "zh": "程式顯示：7"
          }
        ]
      },
      {
        "title": {
          "en": "Function 2 - Discussion Timer",
          "zh": "功能2 - 討論計時器"
        },
        "steps": [
          {
            "en": "Input 60 to M",
            "zh": "輸入60到M"
          },
          {
            "en": "Timer counts down 60 seconds",
            "zh": "計時器倒數60秒"
          },
          {
            "en": "Program will display when timer reaches 0",
            "zh": "當計時完畢，程式會重新顯示"
          }
        ]
      },
      {
        "title": {
          "en": "Function 3 - Play Quest Cards",
          "zh": "功能3 - 出任務牌"
        },
        "steps": [
          {
            "en": "Input 5 to M (play 5 quest cards)",
            "zh": "輸入5到M（出5張任務牌）"
          },
          {
            "en": "Input 0 to D to play success card",
            "zh": "輸入0到D出任務成功牌"
          },
          {
            "en": "Input 1 to D to play failure card",
            "zh": "輸入1到D出任務失敗牌"
          },
          {
            "en": "Program displays 1 in X, there is 1 failure card played",
            "zh": "程式顯示X為1，有1張任務失敗牌"
          }
        ]
      },
      {
        "title": {
          "en": "Function 4 - Draw Character Cards",
          "zh": "功能4 - 抽身份牌"
        },
        "steps": [
          {
            "en": "Input 0 to M",
            "zh": "輸入0到M"
          },
          {
            "en": "Input 10 to A (10 players)",
            "zh": "輸入10到A（10個玩家）"
          },
          {
            "en": "Input 3 to B (3 evil loyalty characters)",
            "zh": "輸入3到B（3個壞人陣營角色）"
          },
          {
            "en": "Input 2 to C (2 good loyalty special characters)",
            "zh": "輸入2到C（2個好人陣營特殊角色）"
          },
          {
            "en": "Program displays GσσD 1 (good loyalty character 1)",
            "zh": "程式顯示GσσD 1（好人陣營角色1）"
          },
          {
            "en": "Program displays GσσD 69 (good loyalty ordinary villager)",
            "zh": "程式顯示GσσD 69（好人陣營平民）"
          },
          {
            "en": "Program displays BAD 2 (evil loyalty character 2)",
            "zh": "程式顯示BAD 2（壞人陣營角色2）"
          }
        ]
      }
    ]
  },
  "analysis": [
    {
      "title": {
        "en": "Draw character cards without replacement",
        "zh": "不重複抽角色牌"
      },
      "problem": {
        "en": "Casio Fx-50FH II do not have data structures like list, set or map to store drawn cards.",
        "zh": "Casio Fx-50FH II 沒有列表、集合或映射等數據結構來儲存已抽出的角色牌。"
      },
      "solution": {
        "en": "Use decimal places to store drawn cards",
        "zh": "用小數點位置儲存已抽出的牌。"
      },
      "steps": [
        {
          "title": {
            "en": "Example: 10 players",
            "zh": "例子：10個玩家"
          },
          "explanation": {
            "en": "We first get a random number from 1 to 10, for example 3.",
            "zh": "我們首先從1到10獲得一個隨機數，例如3。"
          }
        },
        {
          "formula": "0.0010000000",
          "title": {
            "en": "The nth 0 in \"Drawn Card Memory\"",
            "zh": "「已抽牌記憶」的第n個0"
          },
          "explanation": {
            "en": "The 3rd 0 in \"Drawn Card Memory\" is in the 3rd decimal place, so the card number is 3. Update the 3rd 0 to 1.",
            "zh": "「已抽牌記憶」的第3個0在第3個小數位，所以牌號是3。更新第3個小數位為1。"
          }
        },
        {
          "title": {
            "en": "Second run",
            "zh": "第二次抽牌"
          },
          "explanation": {
            "en": "In second run, we get a random number from 1 to 9, because there are 9 zeros left. For example we get 4.",
            "zh": "在第二次抽牌時，我們從1到9獲得一個隨機數，因為還有9個零，例如我們得到4。"
          }
        },
        {
          "formula": "0.0010100000",
          "title": {
            "en": "The nth 0 in \"Drawn Card Memory\"",
            "zh": "「已抽牌記憶」的第n個0"
          },
          "explanation": {
            "en": "Now the 4th 0 in \"Drawn Card Memory\" is actually in position 5, so the card number is 5. Update the 5th 0 to 1.",
            "zh": "「已抽牌記憶」的第4個0實際上是第5個小數位，所以牌號是5。更新第5個小數位為1。"
          }
        },
        {
          "title": {
            "en": "Last run",
            "zh": "最後一次抽牌"
          },
          "formula": "0.1111110111",
          "explanation": {
            "en": "Thus, the last random number must be 1, which is the 1st 0, in this example in the 7th decimal place, so the card number is 7",
            "zh": "如此類推，最後的隨機數必為1，即第1個零，在這例子中在第7個小數位，所以牌號是7。"
          }
        },
        {
          "title": {
            "en": "Performance discussion",
            "zh": "性能討論"
          },
          "explanation": {
            "en": "Unlike the implementation in Poker Dealer, this implementation does not incur colision, providing a more consistent performance.",
            "zh": "有別於啤牌機，這個方法不會發生出現隨機數碰撞，能提供更穩定的性能。"
          }
        }
      ]
    }
  ]
}