{
  "id": "dice_roll",
  "name": {
    "en": "Dice Roll",
    "zh": "骰盅"
  },
  "description": {
    "en": "A dice rolling simulator that supports customizable dice count and die size. Perfect for board games and probability experiments.",
    "zh": "骰盅模擬器，支援自定骰子數量和面數，適合桌遊和概率實驗。"
  },
  "image": "/images/programs/dice.png",
  "mode": "Comp",
  "memory": 213,
  "code": [
    {
      "code": "5→A:?→A:6→B:?→B:Lbl 0:Fix 0:0→M:",
      "bytes": 26,
      "comment": {
        "en": "Input dice count and die size",
        "zh": "輸入骰子數量和面數"
      }
    },
    {
      "code": "123456789→Y:Rnd(Y₁₀^(A-9)-.5→Y:",
      "bytes": 25,
      "comment": {
        "en": "Set up \"Re-roll All\" command",
        "zh": "設定「重擲全部」指令"
      }
    },
    {
      "code": "Lbl 5:Fix 0:While Y:Rnd(.1Y-.5→X:A-Y+10X→D:X→Y:(D<0)+(D>A-1⇒Goto 5:",
      "bytes": 49,
      "comment": {
        "en": "Retrieve re-roll position",
        "zh": "讀取重擲位置"
      }
    },
    {
      "code": "M<₁₀^(A-1⇒Goto 6:M₁₀^(-D:Rnd(Ans-10Rnd(.1Ans-.5)-.5:Ans₁₀^(DM⁻:",
      "bytes": 37,
      "comment": {
        "en": "Remove current die",
        "zh": "移除原有骰子"
      }
    },
    {
      "code": "Lbl 6:Rnd(10³Ran#÷Rnd(10³÷B-.5)+.5→X:X>B⇒Goto 6:X₁₀^(DM⁺:WhileEnd:",
      "bytes": 39,
      "comment": {
        "en": "Add new die",
        "zh": "加入新骰子"
      }
    },
    {
      "code": "Lbl 9:Norm 2:M→Y:?→Y:(Y<0)+(Y=M⇒Goto 9:Y=0⇒Goto 0:Goto 5",
      "bytes": 37,
      "comment": {
        "en": "Display current dice, Input command",
        "zh": "顯示所有骰子，輸入指令"
      }
    }
  ],
  "guide": {
    "parameters": {
      "en": [
        "A: Dice count (default: 5)",
        "B: Die size (default: 6)",
        "Y: Display current dice, Input command"
      ],
      "zh": [
        "A: 骰子數量 (預設: 5粒)",
        "B: 骰子面數 (預設: 6面)",
        "Y: 顯示所有骰子，輸入指令"
      ]
    },
    "instructions": {
      "en": [
        "Set dice count to N: Input N to A",
        "Set die size to M: Input M to B",
        "All current dice are displayed in Y",
        "Re-roll specific dice: Input positions to Y",
        "Re-roll all dice: Enter 0 to Y",
        "Positions are ordered from left to right: 123456789"
      ],
      "zh": [
        "設置骰子數量為N：輸入N到A",
        "設置骰子面數為M：輸入M到B",
        "現有骰子會顯示在Y",
        "重擲特定骰子：輸入位置到Y",
        "重擲所有骰子：輸入0到Y",
        "位置由左至右：123456789"
      ]
    },
    "examples": [
      {
        "title": {
          "en": "Re-roll specific dice",
          "zh": "重擲特定骰子"
        },
        "steps": [
          {
            "en": "Y displays: 24136",
            "zh": "Y 顯示：24136"
          },
          {
            "en": "Input 24 to Y",
            "zh": "在 Y 中輸入 24"
          },
          {
            "en": "Program re-rolls positions 2 and 4 (Dice of value 4 and 3)",
            "zh": "重擲位置 2 和 4 (骰面值 4 和 3)"
          },
          {
            "en": "Y displays: 22156 (positions 1, 3 and 5 are kept)",
            "zh": "Y 顯示：22156 (位置 1， 3 和 5 保持不變)"
          }
        ]
      },
      {
        "title": {
          "en": "Re-roll all dice",
          "zh": "重擲所有骰子"
        },
        "steps": [
          {
            "en": "Y displays: 24136",
            "zh": "Y 顯示：24136"
          },
          {
            "en": "Input 0 to Y",
            "zh": "在 Y 中輸入 0"
          },
          {
            "en": "Program re-rolls all dice",
            "zh": "重擲所有骰仔"
          },
          {
            "en": "Y displays: 56241",
            "zh": "Y 顯示：56241"
          }
        ]
      }
    ]
  },
  "analysis": [
    {
      "title": {
        "en": "Equal Probability Random Number Generation",
        "zh": "生成同等概率的隨機數"
      },
      "problem": {
        "en": "Casio Fx-50FH II built-in random number generator ranges from 0 to 0.999, 1000 outcomes which sometimes cannot be equally divided by die size.",
        "zh": "Casio Fx-50FH II 內置的隨機數生成器範圍是0到0.999，1000個結果有時無法被骰子面數等分。"
      },
      "solution": {
        "en": "We have to calculate which outcomes should be discarded to ensure each die size has equal probability. As seen in the graph, using die size 6 as an example. The 4 outcomes from 0.996 to 0.999 are group to 7 and should be discarded.",
        "zh": "我們要計算哪些結果應該被丟棄，以確保每個骰子面數都有相等的概率。圖中，以骰子面數6為例，0.996到0.999的4個結果被分組到7，應該被丟棄。"
      },
      "image": "/images/analysis/equal_probi_draw.png",
      "steps": [
        {
          "title": {
            "en": "Example: Die size 6",
            "zh": "例子：骰子面數6"
          },
          "formula": "1000 ÷ 6 = 166.67",
          "explanation": {
            "en": "1000 outcomes cannot be equally divided by die size 6. The die sides would have different probabilities.",
            "zh": "1000個結果無法被骰子面數6等分，骰子面會有不相同的概率。"
          }
        },
        {
          "title": {
            "en": "Maximum equal probability outcomes",
            "zh": "計算有效範圍"
          },
          "formula": "floor(1000 ÷ 6) = 166",
          "explanation": {
            "en": "This calculates the maximum number of outcomes for each die side to have equal probability. For die size 6, the maximum number of equal probability outcomes is 166.",
            "zh": "這計算出每個骰子面數最多可以有多少個結果，以確保每個骰子面數都有相等的概率。對於骰子面數6，每面最多分得166個結果。"
          }
        },
        {
          "title": {
            "en": "Group random number outcomes",
            "zh": "將隨機數結果分組"
          },
          "formula": "ceil(1000 • Ran# ÷ 166)",
          "explanation": {
            "en": "This groups the random number outcomes into groups of 1 to 7. Each group has 166 outcomes, except the last group 7 which has 4 outcomes from 0.996 to 0.999. They are excess outcomes to be discarded.",
            "zh": "這將隨機數結果分為1至7組，每組有166個結果，除了最後一組7，有4個結果0.996到0.999。它們是過剩的結果，需要被丟棄。"
          }
        },
        {
          "title": {
            "en": "Reject group greater than die size",
            "zh": "拒絕大於骰子面數的組"
          },
          "formula": "X>B⇒Goto 6:",
          "explanation": {
            "en": "When we get a group that is greater than the number of sides, we need to reject it and try again.",
            "zh": "當我們得到大於骰子面數的組，需要拒絕並重試。"
          }
        }
      ]
    }
  ]
}